<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Inverse Probability of Censoring Weights</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Inverse Probability of Censoring
Weights</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(trtswitch)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The inverse probability of censoring weights (IPCW) method is a
powerful tool for adjusting survival analysis in the presence of
treatment switching. In scenarios where patients switch treatments,
survival data are artificially censored, leading to biased estimates if
not properly addressed. This bias arises because the decision to switch
treatments may depend on prognostic factors that also influence survival
outcomes.</p>
<p>To mitigate this bias, researchers gather data on prognostic
covariates at baseline and at regular intervals until one of the
following occurs: a treatment switch, death, drop-out, or the end of the
follow-up period. A “switching model” is then developed to estimate
weights for each patient at each time point. These weights represent the
inverse probability of remaining unswitched over time. Each patient
retains an unstabilized weight greater than or equal to 1, which
accounts for both their own data and that of switchers with similar
prognostic profiles.</p>
<p>Finally, an “outcome” model utilizing IPCW-weighted survival times is
employed to estimate the treatment effect, adjusted for switching.</p>
</div>
<div id="estimation-of-weights" class="section level1">
<h1>Estimation of weights</h1>
<p>The switching model can be implemented using either pooled logistic
regression or proportional hazards regression with time-dependent
covariates.</p>
<div id="pooled-logistic-regression-model" class="section level2">
<h2>Pooled Logistic Regression Model</h2>
<p>Let <span class="math inline">\(A_{i,j}\)</span> denote the indicator
of alternative therapy for subject <span class="math inline">\(i\)</span> in treatment cycle <span class="math inline">\(j\)</span>. We assume that once a patient switched
to an alternative therapy, he/she will stay on the alternative therapy.
Let <span class="math inline">\(X_i\)</span> denote the baseline
covariates for subject <span class="math inline">\(i\)</span> and <span class="math inline">\(L_{i,j}\)</span> denote the time-dependent
covariates for subject <span class="math inline">\(i\)</span> at the
start of cycle <span class="math inline">\(j\)</span>. For the pooled
logistic regression model for treatment switching, the full data will be
used for patients who didn’t switch treatment, while the partial data up
to and including the treatment cycle when the patient switched treatment
will be used for patients who switched treatment. The logistic
regression model is used to estimate <span class="math display">\[P(A_j
= 0 | \bar{A}_{j-1} = \bar{0}, \bar{L}_{j} = \bar{l}_{i,j}, X =
x_i)\]</span> where <span class="math inline">\(x_i\)</span>, <span class="math inline">\(l_{i,j}\)</span>, and <span class="math inline">\(a_{i,j}\)</span> denote the observed value of
baseline covariates, time-dependent covariates at the start of cycle
<span class="math inline">\(j\)</span>, and alternative therapy status
for cycle <span class="math inline">\(j\)</span> of subject <span class="math inline">\(i\)</span>, respectively. A subject is on
alternative therapy in cycle <span class="math inline">\(j\)</span> if
and only if treatment switching has occurred at the start of that cycle,
which is equivalent to switching having occurred by the end of cycle
<span class="math inline">\(j−1\)</span>. Consequently, lagged values of
time-dependent covariates are often used in the logistic regression
model. Natural cubic splines can be used to model visit-specific
intercepts for the pooled logistic regression model. The unstabilized
weights for subject <span class="math inline">\(i\)</span> for cycle
<span class="math inline">\(t\)</span> are given by <span class="math display">\[w_i(t) = \prod_{j=1}^{t} \frac{1}{P(A_j = 0 |
\bar{A}_{j-1} = \bar{0}, \bar{L}_{j} = \bar{l}_{i,j}, X = x_i)}\]</span>
In the IPCW method, all visits that occur after treatment switching are
excluded from the weighted outcome model. Accordingly, the weights are
defined as the inverse probability of not having switched at the start
of each cycle.</p>
<p>When using pooled logistic regression for the switching model, the
following specifications can be made:</p>
<ul>
<li><p><strong>Visit-Specific Intercepts</strong>: These can be modeled
using a natural cubic spline with specified degrees of freedom, denoted
as <span class="math inline">\(\nu\)</span> (corresponding to the
<code>ns_df</code> parameter of the <code>ipcw</code> function). The
boundary and internal knots can be based on the range and percentiles of
observed treatment switching times, respectively. Here, <span class="math inline">\(\nu\)</span> equals the number of internal knots
plus one; a value of <span class="math inline">\(\nu=0\)</span>
indicates a common intercept, while <span class="math inline">\(\nu=1\)</span> leads to a linear effect of visit.
By default, <span class="math inline">\(\nu=3\)</span>, which implies
two internal knots for the cubic spline.</p></li>
<li><p><strong>Stratification Factors</strong>: If more than one
stratification factor exists, they can be included in the logistic model
either as main effects only
(<code>strata_main_effect_only = TRUE</code>) or as all possible
combinations of the levels of the stratification factors
(<code>strata_main_effect_only = FALSE</code>).</p></li>
<li><p><strong>Handling Nonconvergence</strong>: If the pooled logistic
regression model encounters issues such as complete or quasi-complete
separation, Firth’s bias-reducing penalized likelihood method
(<code>firth = TRUE</code>) can be applied alongside intercept
correction (<code>flic = TRUE</code>) to yield more accurate predicted
probabilities.</p></li>
</ul>
</div>
<div id="proportional-hazards-model" class="section level2">
<h2>Proportional Hazards Model</h2>
<p>When using a Cox model with time-dependent covariates as the
switching model, adjacent observations within a subject may be combined
as long as the values of time-dependent covariates do not change over
each combined interval. This approach saves data storage but
observations across subjects will not be aligned at regular intervals.
In this case, unique event times across treatment arms should be
replicated within each subject, enabling the availability of weights at
each event time.</p>
<p>In the time-dependent Cox switching model, survival times are
artificially censored at the point of treatment switching. The IPCW
weight is then defined as the probability of not having switched
treatment by the end of the time interval. This is to account for the
irregular visit structure for the time-dependent Cox switching
model.</p>
</div>
<div id="stabilized-weights" class="section level2">
<h2>Stabilized Weights</h2>
<p>To address the high variability in “unstabilized” weights,
researchers often opt for “stabilized” weights. The switching model for
stabilized weights involves a model for the numerator of the weight in
addition to the model for the denominator. Typically, the numerator
model mirrors the denominator model but includes only prognostic
baseline variables. Any baseline variables included in the numerator
must be part of the weighted outcome model. Any baseline variables
included in the weighted outcome model must also be part of the
denominator.</p>
</div>
<div id="truncation-of-weights" class="section level2">
<h2>Truncation of Weights</h2>
<p>You can specify weight truncation using the <code>trunc</code> and
<code>trunc_upper_only</code> parameters of the <code>ipcw</code>
function. The <code>trunc</code> parameter is a number between 0 and 0.5
that represents the fraction of the weight distribution to truncate. The
<code>trunc_upper_only</code> parameter is a flag that indicates whether
to truncate weights only from the upper end of the weight
distribution.</p>
</div>
</div>
<div id="estimation-of-hazard-ratio" class="section level1">
<h1>Estimation of Hazard Ratio</h1>
<p>Once weights have been obtained for each event time in the data set,
we fit a (potentially stratified) Cox proportional hazards model to this
weighted data set to obtain an estimate of the hazard ratio. The
confidence interval for the hazard ratio can be obtained from the
weighted Cox model with robust sandwich variance estimates or derived by
bootstrapping the weight estimation and the subsequent model-fitting
process.</p>
<div id="example-for-pooled-logistic-regression-switching-model" class="section level2">
<h2>Example for Pooled Logistic Regression Switching Model</h2>
<p>First we prepare the data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>sim1 <span class="ot">&lt;-</span> <span class="fu">tssim</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">tdxo =</span> <span class="dv">1</span>, <span class="at">coxo =</span> <span class="dv">1</span>, <span class="at">allocation1 =</span> <span class="dv">1</span>, <span class="at">allocation2 =</span> <span class="dv">1</span>,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">p_X_1 =</span> <span class="fl">0.3</span>, <span class="at">p_X_0 =</span> <span class="fl">0.3</span>, </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">rate_T =</span> <span class="fl">0.002</span>, <span class="at">beta1 =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">beta2 =</span> <span class="fl">0.3</span>, </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">gamma0 =</span> <span class="fl">0.3</span>, <span class="at">gamma1 =</span> <span class="sc">-</span><span class="fl">0.9</span>, <span class="at">gamma2 =</span> <span class="fl">0.7</span>, <span class="at">gamma3 =</span> <span class="fl">1.1</span>, <span class="at">gamma4 =</span> <span class="sc">-</span><span class="fl">0.8</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">zeta0 =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">zeta1 =</span> <span class="fl">0.5</span>, <span class="at">zeta2 =</span> <span class="fl">0.2</span>, <span class="at">zeta3 =</span> <span class="sc">-</span><span class="fl">0.4</span>, </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">alpha0 =</span> <span class="fl">0.5</span>, <span class="at">alpha1 =</span> <span class="fl">0.5</span>, <span class="at">alpha2 =</span> <span class="fl">0.4</span>, </span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">theta1_1 =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">theta1_0 =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">theta2 =</span> <span class="fl">0.2</span>,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="at">rate_C =</span> <span class="fl">0.0000855</span>, <span class="at">accrualIntensity =</span> <span class="dv">20</span><span class="sc">/</span><span class="dv">30</span>, </span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="at">fixedFollowup =</span> <span class="dv">0</span>, <span class="at">plannedTime =</span> <span class="dv">1350</span>, <span class="at">days =</span> <span class="dv">30</span>,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">500</span>, <span class="at">NSim =</span> <span class="dv">100</span>, <span class="at">seed =</span> <span class="dv">314159</span>)</span></code></pre></div>
<p>Given that the observations are collected at regular intervals, we
can use a pooled logistic regression switching model. In this model, the
prognostic baseline variable is represented by <code>bprog</code>, while
<code>L</code> serves as a time-dependent covariate. Additionally,
<code>ns1</code>, <code>ns2</code>, and <code>ns3</code> are the three
terms for the natural cubic spline with <span class="math inline">\(\nu=3\)</span> degrees of freedom for
visit-specific intercepts.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">ipcw</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  sim1[[<span class="dv">1</span>]], <span class="at">id =</span> <span class="st">&quot;id&quot;</span>, <span class="at">tstart =</span> <span class="st">&quot;tstart&quot;</span>, </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">tstop =</span> <span class="st">&quot;tstop&quot;</span>, <span class="at">event =</span> <span class="st">&quot;event&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;trtrand&quot;</span>, </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">swtrt =</span> <span class="st">&quot;xo&quot;</span>, <span class="at">swtrt_time =</span> <span class="st">&quot;xotime&quot;</span>, </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">base_cov =</span> <span class="st">&quot;bprog&quot;</span>, <span class="at">numerator =</span> <span class="st">&quot;bprog&quot;</span>, </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">denominator =</span> <span class="fu">c</span>(<span class="st">&quot;bprog&quot;</span>, <span class="st">&quot;L&quot;</span>),</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">logistic_switching_model =</span> <span class="cn">TRUE</span>, <span class="at">ns_df =</span> <span class="dv">3</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">swtrt_control_only =</span> <span class="cn">TRUE</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The fits for the denominator and numerator switching models for the
control arm are as follows.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># denominator switching model fit</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>fit1<span class="sc">$</span>fit_switch[[<span class="dv">1</span>]]<span class="sc">$</span>fit_den<span class="sc">$</span>parest[, <span class="fu">c</span>(<span class="st">&quot;param&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sebeta&quot;</span>, <span class="st">&quot;z&quot;</span>)]</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;         param       beta    sebeta           z</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 1 (Intercept) -4.3938500 0.4364956 -10.0661945</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 2       bprog  0.3602200 0.2453795   1.4680116</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 3           L  0.3064046 0.3067097   0.9990053</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 4         ns1 -0.8325131 0.6223178  -1.3377621</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 5         ns2  2.1816608 0.8374703   2.6050606</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 6         ns3  0.9189778 0.7471678   1.2299482</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co"># numerator switching model fit</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>fit1<span class="sc">$</span>fit_switch[[<span class="dv">1</span>]]<span class="sc">$</span>fit_num<span class="sc">$</span>parest[, <span class="fu">c</span>(<span class="st">&quot;param&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sebeta&quot;</span>, <span class="st">&quot;z&quot;</span>)]</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt;         param       beta    sebeta          z</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; 1 (Intercept) -4.1873341 0.3784297 -11.065025</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; 2       bprog  0.4102063 0.2409982   1.702114</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; 3         ns1 -0.8233014 0.6204201  -1.327006</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; 4         ns2  2.2205113 0.8361129   2.655755</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; 5         ns3  0.9264175 0.7453640   1.242906</span></span></code></pre></div>
<p>Since treatment switching is not allowed in the experimental arm, the
weights are identical to 1 for subjects in the experimental group. The
unstabilized and stablized weights for the control group are plotted
below.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># unstabilized weights</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">ggplot</span>(fit1<span class="sc">$</span>data_outcome <span class="sc">%&gt;%</span> <span class="fu">filter</span>(trtrand <span class="sc">==</span> <span class="dv">0</span>), </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> unstabilized_weight)) <span class="sc">+</span> </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;#77bd89&quot;</span>, <span class="at">color=</span><span class="st">&quot;#1f6e34&quot;</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;unstabilized weights&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co"># stabilized weights</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">ggplot</span>(fit1<span class="sc">$</span>data_outcome <span class="sc">%&gt;%</span> <span class="fu">filter</span>(trtrand <span class="sc">==</span> <span class="dv">0</span>), </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> stabilized_weight)) <span class="sc">+</span> </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;#77bd89&quot;</span>, <span class="at">color=</span><span class="st">&quot;#1f6e34&quot;</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;stabilized weights&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Now we fit a weighted outcome Cox model and compare the treatment
hazard ratio estimate with the reported.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>fit1<span class="sc">$</span>fit_outcome<span class="sc">$</span>parest[, <span class="fu">c</span>(<span class="st">&quot;param&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sebeta&quot;</span>, <span class="st">&quot;z&quot;</span>)]</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;     param       beta    sebeta         z</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; 1 treated -0.5919728 0.1118087 -5.294515</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; 2   bprog  0.1652406 0.1196620  1.380894</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    </span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">exp</span>(fit1<span class="sc">$</span>fit_outcome<span class="sc">$</span>parest[<span class="dv">1</span>, <span class="fu">c</span>(<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>)])</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt;        beta     lower     upper</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 1 0.5532348 0.4443629 0.6887811</span></span></code></pre></div>
</div>
<div id="example-for-time-dependent-cox-switching-model" class="section level2">
<h2>Example for Time-Dependent Cox Switching Model</h2>
<p>Now we apply the IPCW method using a Cox proportional hazards model
with time-dependent covariates as the switching model.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">ipcw</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  shilong, <span class="at">id =</span> <span class="st">&quot;id&quot;</span>, <span class="at">tstart =</span> <span class="st">&quot;tstart&quot;</span>, <span class="at">tstop =</span> <span class="st">&quot;tstop&quot;</span>, </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">event =</span> <span class="st">&quot;event&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;bras.f&quot;</span>, <span class="at">swtrt =</span> <span class="st">&quot;co&quot;</span>, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">swtrt_time =</span> <span class="st">&quot;dco&quot;</span>, </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">base_cov =</span> <span class="fu">c</span>(<span class="st">&quot;agerand&quot;</span>, <span class="st">&quot;sex.f&quot;</span>, <span class="st">&quot;tt_Lnum&quot;</span>, <span class="st">&quot;rmh_alea.c&quot;</span>, </span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>               <span class="st">&quot;pathway.f&quot;</span>),</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="at">numerator =</span> <span class="fu">c</span>(<span class="st">&quot;agerand&quot;</span>, <span class="st">&quot;sex.f&quot;</span>, <span class="st">&quot;tt_Lnum&quot;</span>, <span class="st">&quot;rmh_alea.c&quot;</span>, </span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>                <span class="st">&quot;pathway.f&quot;</span>),</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="at">denominator =</span> <span class="fu">c</span>(<span class="st">&quot;agerand&quot;</span>, <span class="st">&quot;sex.f&quot;</span>, <span class="st">&quot;tt_Lnum&quot;</span>, <span class="st">&quot;rmh_alea.c&quot;</span>,</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>                  <span class="st">&quot;pathway.f&quot;</span>, <span class="st">&quot;ps&quot;</span>, <span class="st">&quot;ttc&quot;</span>, <span class="st">&quot;tran&quot;</span>),</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="at">swtrt_control_only =</span> <span class="cn">FALSE</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The fits for the denominator and numerator switching models for the
control arm are as follows.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># denominator switching model for the control group</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>fit2<span class="sc">$</span>fit_switch[[<span class="dv">1</span>]]<span class="sc">$</span>fit_den<span class="sc">$</span>parest[, <span class="fu">c</span>(<span class="st">&quot;param&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sebeta&quot;</span>, <span class="st">&quot;z&quot;</span>)]</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt;                    param         beta     sebeta           z</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; 1                agerand  0.007642073 0.01023088  0.74696131</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; 2            sex.fFemale -0.364211003 0.28631111 -1.27208128</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; 3                tt_Lnum  0.042406215 0.05314773  0.79789331</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; 4             rmh_alea.c -0.351616244 0.27416745 -1.28248719</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; 5            pathway.fHR -0.041768569 0.43444787 -0.09614173</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; 6 pathway.fPI3K.AKT.mTOR  0.267055320 0.43736340  0.61060281</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; 7                     ps  0.103478553 0.18544824  0.55799156</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; 8                    ttc -0.480378314 0.33557237 -1.43151926</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; 9                   tran  0.295828936 0.45806296  0.64582592</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co"># numerator switching model for the control group</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>fit2<span class="sc">$</span>fit_switch[[<span class="dv">1</span>]]<span class="sc">$</span>fit_num<span class="sc">$</span>parest[, <span class="fu">c</span>(<span class="st">&quot;param&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sebeta&quot;</span>, <span class="st">&quot;z&quot;</span>)]</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt;                    param        beta      sebeta           z</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; 1                agerand  0.01059477 0.009501694  1.11503993</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; 2            sex.fFemale -0.32452112 0.283829120 -1.14336794</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; 3                tt_Lnum  0.05956492 0.051120376  1.16518947</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; 4             rmh_alea.c -0.29758402 0.266335628 -1.11732711</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; 5            pathway.fHR  0.02467202 0.429102680  0.05749678</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; 6 pathway.fPI3K.AKT.mTOR  0.28245603 0.434306994  0.65036030</span></span></code></pre></div>
<p>The fits for the denominator and numerator switching models for the
experimental arm are as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># denominator switching model for the experimental group</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>fit2<span class="sc">$</span>fit_switch[[<span class="dv">2</span>]]<span class="sc">$</span>fit_den<span class="sc">$</span>parest[, <span class="fu">c</span>(<span class="st">&quot;param&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sebeta&quot;</span>, <span class="st">&quot;z&quot;</span>)]</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt;                    param         beta     sebeta          z</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; 1                agerand -0.002639441 0.01796294 -0.1469381</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; 2            sex.fFemale  0.428028469 0.47154276  0.9077193</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; 3                tt_Lnum -0.152758042 0.10774494 -1.4177746</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; 4             rmh_alea.c  0.210365664 0.50502449  0.4165455</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; 5            pathway.fHR  1.774466817 1.04918789  1.6912765</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; 6 pathway.fPI3K.AKT.mTOR  0.859950234 1.08995673  0.7889765</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; 7                     ps  0.261142698 0.27003546  0.9670682</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; 8                    ttc -0.408175689 0.53635218 -0.7610218</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; 9                   tran  1.053347294 0.69246856  1.5211482</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co"># numerator switching model for the experimental group</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>fit2<span class="sc">$</span>fit_switch[[<span class="dv">2</span>]]<span class="sc">$</span>fit_num<span class="sc">$</span>parest[, <span class="fu">c</span>(<span class="st">&quot;param&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sebeta&quot;</span>, <span class="st">&quot;z&quot;</span>)]</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt;                    param         beta     sebeta           z</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt; 1                agerand  0.001625622 0.01812956  0.08966694</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; 2            sex.fFemale  0.476979559 0.45994387  1.03703863</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co">#&gt; 3                tt_Lnum -0.160020273 0.10615092 -1.50747886</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; 4             rmh_alea.c  0.154833260 0.48178554  0.32137382</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; 5            pathway.fHR  1.841535014 1.03960949  1.77137188</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#&gt; 6 pathway.fPI3K.AKT.mTOR  1.064637540 1.06675981  0.99801055</span></span></code></pre></div>
<p>Below, the unstabilized and stabilized weights are plotted by
treatment group: the left panel displays data for the control group,
while the right panel shows data for the experimental group.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># unstabilized weights</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">ggplot</span>(fit2<span class="sc">$</span>data_outcome, <span class="fu">aes</span>(<span class="at">x =</span> unstabilized_weight)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;#77bd89&quot;</span>, <span class="at">color=</span><span class="st">&quot;#1f6e34&quot;</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;unstabilized weights&quot;</span>) <span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>treated) </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># stabilized weights</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">ggplot</span>(fit2<span class="sc">$</span>data_outcome, <span class="fu">aes</span>(<span class="at">x =</span> stabilized_weight)) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;#77bd89&quot;</span>, <span class="at">color=</span><span class="st">&quot;#1f6e34&quot;</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;stabilized weights&quot;</span>) <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>treated)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Finally, we fit the weighted outcome Cox model and compare the
treatment hazard ratio estimate with the reported.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>fit2<span class="sc">$</span>fit_outcome<span class="sc">$</span>parest[, <span class="fu">c</span>(<span class="st">&quot;param&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sebeta&quot;</span>, <span class="st">&quot;z&quot;</span>)]</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#&gt;                    param         beta     sebeta          z</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; 1                treated  0.356390611 0.25526832  1.3961412</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; 2                agerand -0.006047034 0.01018596 -0.5936636</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; 3            sex.fFemale -0.487409540 0.24458876 -1.9927716</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; 4                tt_Lnum  0.011244574 0.04147245  0.2711336</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; 5             rmh_alea.c  0.941651485 0.25315061  3.7197283</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; 6            pathway.fHR -0.127273307 0.35878557 -0.3547336</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; 7 pathway.fPI3K.AKT.mTOR -0.166035907 0.34997206 -0.4744262</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="fu">c</span>(fit2<span class="sc">$</span>hr, fit2<span class="sc">$</span>hr_CI)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; [1] 1.4281653 0.8659517 2.3553924</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
