<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Rank Preserving Structural Failure Time Models</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Rank Preserving Structural Failure Time
Models</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(trtswitch)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In clinical trials, treatment switching occurs when patients in the
control group switch to the experimental treatment after experiencing
disease progression or other clinical criteria. While treatment
switching can provide ethical benefits for trial participants, it
introduces significant challenges in estimating the true effect of the
experimental treatment on overall survival (OS). If left unadjusted,
treatment switching can obscure the real difference between the
treatment arms and lead to biased estimates, typically underestimating
the treatment benefit.</p>
<p>The rank preserving structural failure time model (RPSFTM) is a
statistical approach developed to address this issue. RPSFTM adjusts for
the effects of treatment switching by modeling what the survival times
of patients who switched treatments would have been if they had remained
on the control treatment. The model assumes that the treatment effect is
the same regardless of when the patient received the treatment.</p>
<p>The rank-preserving property means that the relative ordering of
counterfactural survival times under the experimental treatment is the
same as the relative ordering of counterfactural survival times under
the control treatment. Formally, let <span class="math inline">\(Y_i^{a=1}\)</span> represent the potential outcome
for subject <span class="math inline">\(i\)</span> under treatment
condition <span class="math inline">\(a=1\)</span> (experimental), and
<span class="math inline">\(Y_i^{a=0}\)</span> represent the potential
outcome under treatment condition <span class="math inline">\(a=0\)</span> (control). If the ranking of <span class="math inline">\(\{Y_i^{a=1}: i=1,\ldots,n\}\)</span> is identical
to the ranking of <span class="math inline">\(\{Y_i^{a=0}:
i=1,\ldots,n\}\)</span>, we say that rank preservation holds.</p>
<p>The structural failure time model refers to a framework used to
estimate the true (unobserved) survival time in the absence of treatment
switching, assuming that the experimental treatment has a multiplicative
effect on survival. Specifically, each patient’s observed survival time,
<span class="math inline">\(T_i\)</span>, is divided into the time spent
on the control treatment, <span class="math inline">\(T_{C_i}\)</span>,
and the time spent on the experimental treatment, <span class="math inline">\(T_{E_i}\)</span>, such that <span class="math inline">\(T_i = T_{C_i} + T_{E_i}\)</span>. The
<code>rx</code> parameter in the <code>rpsftm</code> function represents
the proportion of time spent on the experimental treatment, defined as
the ratio <span class="math inline">\(T_{E_i}/T_i\)</span>. The
structural model for counterfactual untreated survival times is
expressed as <span class="math display">\[U_{i,\psi} = T_{C_i} +
e^{\psi} T_{E_i},\]</span> where there are three distinct cases for
one-way treatment switching from the control arm to the experimental
arm:</p>
<ul>
<li><p><strong>Experimental Group Patients</strong>: <span class="math inline">\(T_{C_i} = 0\)</span>, and <span class="math inline">\(T_{E_i}\)</span> represents the time from
randomization to either death or censoring.</p></li>
<li><p><strong>Control Group Nonswitchers</strong>: <span class="math inline">\(T_{C_i}\)</span> is the time from randomization to
either death or censoring, and <span class="math inline">\(T_{E_i} =
0\)</span>.</p></li>
<li><p><strong>Control Group Switchers</strong>: <span class="math inline">\(T_{C_i}\)</span> is the time from randomization to
treatment switch, and <span class="math inline">\(T_{E_i}\)</span> is
the time from the switch to either death or censoring.</p></li>
</ul>
</div>
<div id="recensoring" class="section level1">
<h1>Recensoring</h1>
<p>The censoring time <span class="math inline">\(C_i\)</span> must be
defined for all patients including those who experience an event. We
assume that censoring is non-informative in the absence of treatment
switching, i.e., <span class="math inline">\(T_{L_i} \perp\!\!\!\perp
C_i\)</span>, where <span class="math inline">\(T_{L_i}\)</span> denotes
the latent time to event for subject <span class="math inline">\(i\)</span>.</p>
<p>The observed time to event or censoring is given by <span class="math display">\[T_i = \min(T_{C_i} + e^{-\psi}(T_{L_i} -
T_{C_i}), C_i)\]</span> with the event indicator <span class="math display">\[\Delta_{i} = I(T_{C_i} + e^{-\psi}(T_{L_i} -
T_{C_i})\leq C_i)\]</span> For a patient who switches treatment, the
counterfactual time to event or censoring is <span class="math display">\[U_{i,\psi} = \min(T_{L_i}, T_{C_i} + e^{\psi}(C_i
- T_{C_i}))\]</span> and the event indicator can be rewritten as <span class="math display">\[\Delta_{i} = I(T_{L_i} \leq  T_{C_i} +
e^{\psi}(C_i - T_{C_i}))\]</span> However, treatment switching is often
associated with poor prognosis for survival, i.e., <span class="math inline">\(T_{L_i}\)</span> and <span class="math inline">\(T_{C_i}\)</span> are correlated. Consequently,
<span class="math inline">\(T_{L_i}\)</span> and <span class="math inline">\(T_{C_i} + e^{\psi}(C_i - T_{C_i})\)</span> are
also correlated. As a result, using the sample <span class="math inline">\(\{(U_{i,\psi},\Delta_i)\}\)</span> will generally
produce a biased estimate of the survival distribution of <span class="math inline">\(T_{L_i}\)</span>.</p>
<p>To address this issue, we define a recensoring time that accounts for
all possible switching times, <span class="math display">\[
  D_{i,\psi}^* = \min_{T_{C_i} \in [0, C_i]} \{T_{C_i} + e^{\psi}(C_i -
T_{C_i})\} = \min(C_i, e^{\psi}C_i)
\]</span> The recensored time to event or censoring is <span class="math display">\[U_{i,\psi}^* = \min(U_{i,\psi}, D_{i,\psi}^*) =
\min(T_{L_i}, D_{i,\psi}^*)\]</span> with the corresponding event
indicator <span class="math display">\[\Delta_{i,\psi}^* = I(U_{i,\psi}
\leq D_{i,\psi}^*) = I(T_{L_i} \leq D_{i,\psi}^*)\]</span> By
construction, <span class="math inline">\(T_{L_i} \perp\!\!\!\perp
D_{i,\psi}^*\)</span>, thus the sample <span class="math inline">\(\{(U_{i,\psi}^*,\Delta_{i,\psi}^*)\}\)</span>
provides an unbiased estimate of the survival distribution of <span class="math inline">\(T_{L_i}\)</span>.</p>
<p>It is important to note that if recensoring is applied only to
switchers, the sample becomes <span class="math display">\[U_{i,\psi}^{\dagger} = \min(T_{L_i}, D_{i,\psi}^*
I(S_i=1) + C_i I(S_i=0))\]</span> <span class="math display">\[\Delta_{i,\psi}^{\dagger} = I(T_{L_i} \leq
D_{i,\psi}^* I(S_i=1) + C_i I(S_i=0))\]</span> where <span class="math inline">\(S_i\)</span> is the indicator for treatment
switching. Since <span class="math inline">\(S_i\)</span> is correlated
with <span class="math inline">\(T_{L_i}\)</span>, the resulting
censoring time <span class="math inline">\(D_{i,\psi}^* I(S_i=1) + C_i
I(S_i=0)\)</span> is also correlated with <span class="math inline">\(T_{L_i}\)</span>. Therefore, using the sample
<span class="math inline">\(\{(U_{i,\psi}^{\dagger},
\Delta_{i,\psi}^{\dagger})\}\)</span> will lead to biased survival
estimates.</p>
<p>This illustrates that recensoring must be applied to all patients in
treatment arms where treatment switching occurs to obtain unbiased
estimates of the survival distribution.</p>
</div>
<div id="common-treatment-effect-assumption" class="section level1">
<h1>Common Treatment Effect Assumption</h1>
<p>A key assumption for the validity of the RPSFTM is the existence of a
common treatment effect, meaning that the time ratio, <span class="math inline">\(e^{-\psi}\)</span>, remains constant regardless of
when treatment switching occurs. However, since treatment switching
often happens after disease progression, the treatment effect
post-progression may be weaker than the effect observed immediately
following randomization. To account for this in sensitivity analyses,
the <code>treat_modifier</code> parameter in the <code>rpsftm</code>
function can be set to a value between 0 and 1, effectively diluting
<span class="math inline">\(\psi\)</span> by multiplying it by
<code>treat_modifier</code>.</p>
</div>
<div id="estimation-of-psi" class="section level1">
<h1>Estimation of <span class="math inline">\(\psi\)</span></h1>
<p>For a fixed value of <span class="math inline">\(\psi\)</span>, we
can construct the counterfactual untreated survival times <span class="math inline">\(U_{i,\psi}^*\)</span> and the corresponding event
indicators <span class="math inline">\(\Delta_{i,\psi}^*\)</span>. The
<code>psi_test</code> parameter specifies the method used to estimate
<span class="math inline">\(\psi\)</span>.</p>
<ul>
<li><p>When <code>psi_test = &quot;logrank&quot;</code>, a log-rank test (which
may be stratified) is used to compare the counterfactual untreated
survival times between the two treatment groups.</p></li>
<li><p>When <code>psi_test = &quot;phreg&quot;</code>, a Cox proportional hazards
model (which may also be stratified) is used to test for treatment
differences while adjusting for baseline covariates.</p></li>
<li><p>When <code>psi_test = &quot;lifereg&quot;</code>, an accelerated failure
time (AFT) model is used to assess treatment differences, also adjusting
for baseline covariates. If stratification factors are provided, they
are converted into dummy variables and included as covariates in the AFT
model for estimating <span class="math inline">\(\psi\)</span>.</p></li>
</ul>
<p>In all cases, let <span class="math inline">\(Z(\psi)\)</span> denote
the Z-test statistic used to evaluate the treatment effect based on the
counterfactual untreated survival times. Under the assumption that
potential outcomes are independent of the randomized treatment group,
the estimate of <span class="math inline">\(\psi\)</span> is the value
that makes <span class="math inline">\(Z(\psi)\)</span> closest to zero.
The confidence limits for <span class="math inline">\(\psi\)</span> can
be derived from the values of <span class="math inline">\(\psi\)</span>
that yield <span class="math inline">\(Z(\psi)\)</span> closest to <span class="math inline">\(\Phi^{-1}(1 - \alpha/2)\)</span> and <span class="math inline">\(\Phi^{-1}(\alpha/2)\)</span>, where <span class="math inline">\(\Phi(x)\)</span> is the cumulative distribution
function of the standard normal distribution and <span class="math inline">\(\alpha\)</span> is the two-sided significance
level.</p>
<p>The <code>rpsftm</code> function provides two methods for estimating
<span class="math inline">\(\psi\)</span>:</p>
<ol style="list-style-type: decimal">
<li><strong>Grid search method</strong>: This divides the interval from
<code>low_psi</code> to <code>hi_psi</code> into
<code>n_eval_z - 1</code> subintervals and evaluates <span class="math inline">\(Z(\psi)\)</span> at <code>n_eval_z</code> equally
spaced points of <span class="math inline">\(\psi\)</span> (including
the endpoints <code>low_psi</code> and <code>hi_psi</code>).</li>
<li><strong>Root-finding method</strong>: This method uses numerical
techniques, such as Brent’s method, to find the value of <span class="math inline">\(\psi\)</span> such that <span class="math inline">\(Z(\psi) = 0\)</span> for the point estimate, <span class="math inline">\(Z(\psi) = \Phi^{-1}(1 - \alpha/2)\)</span> for the
lower confidence limit, and <span class="math inline">\(Z(\psi) =
\Phi^{-1}(\alpha/2)\)</span> for the upper confidence limit.</li>
</ol>
<p>It is important to note that the solution for <span class="math inline">\(\psi\)</span> may not be unique and may depend on
the search interval and convergence tolerance.</p>
<p>Regardless of the method used for estimating <span class="math inline">\(\psi\)</span>, it is helpful to visualize the
log-rank test statistic, <span class="math inline">\(Z(\psi)\)</span>,
across a range of <span class="math inline">\(\psi\)</span> values.
Additionally, a Kaplan-Meier plot of the counterfactual survival times
for the two randomized groups provides further validation of the
estimated value of <span class="math inline">\(\psi\)</span>.</p>
</div>
<div id="estimation-of-hazard-ratio" class="section level1">
<h1>Estimation of Hazard Ratio</h1>
<p>Let <span class="math inline">\(A_i\)</span> denote the randomized
treatment group and <span class="math inline">\(Z_i\)</span> the
baseline covariates for subject <span class="math inline">\(i\)</span>
(<span class="math inline">\(i=1,\ldots,n\)</span>). Once <span class="math inline">\(\psi\)</span> has been estimated, we can fit a
(potentially stratified) Cox proportional hazards model to the
following:</p>
<ul>
<li><p>The observed survival times of the experimental group: <span class="math inline">\(\{(T_i,\Delta_i,Z_i): A_i = 1\}\)</span></p></li>
<li><p>The counterfactual survival times for the control group: <span class="math inline">\(\{(U_{i,\psi}^*, \Delta_{i,\psi}^*, Z_i): A_i =
0\}\)</span> evaluated at <span class="math inline">\(\psi =
\hat{\psi}\)</span>.</p></li>
</ul>
<p>This allows us to obtain an estimate of the hazard ratio. The
confidence interval for the hazard ratio can be derived by either</p>
<ol style="list-style-type: decimal">
<li>Matching the p-value from the log-rank test for an
intention-to-treat (ITT) analysis, or</li>
<li>Bootstrapping the entire adjustment and subsequent model-fitting
process.</li>
</ol>
</div>
<div id="concorde-trial-example" class="section level1">
<h1>Concorde Trial Example</h1>
<p>We will illustrate the <code>rpsftm</code> function using simulated
data based on the randomized Concorde trial. In this trial, patients
with asymptomatic HIV infection were randomly assigned to either
immediate zidovudine treatment or deferred treatment. The primary
outcome was the time to disease progression or death.</p>
<p>An ITT analysis estimates the effect of immediately administering
zidovudine compared to delaying its use. However, some patients in the
deferred arm started zidovudine before developing symptoms, based on low
CD4 cell counts—a marker of disease progression.</p>
<div id="data" class="section level2">
<h2>Data</h2>
<p>The data are stored in the <code>immdef</code> data frame. Here’s a
snapshot of the data:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">head</span>(immdef, <span class="dv">10</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt;    id def imm censyrs xo    xoyrs prog   progyrs entry</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; 1   1   0   1       3  0 0.000000    0 3.0000000     0</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; 2   2   1   0       3  1 2.652797    0 3.0000000     0</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; 3   3   0   1       3  0 0.000000    1 1.7378377     0</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; 4   4   0   1       3  0 0.000000    1 2.1662905     0</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; 5   5   1   0       3  1 2.122100    1 2.8846462     0</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; 6   6   1   0       3  1 0.557392    0 3.0000000     0</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; 7   7   1   0       3  0 2.189470    1 2.1894703     0</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; 8   8   0   1       3  0 0.000000    1 0.9226239     0</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; 9   9   0   1       3  0 0.000000    0 3.0000000     0</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; 10 10   0   1       3  0 0.000000    0 3.0000000     0</span></span></code></pre></div>
<p>For the immediate treatment arm, treatment crossover was not
possible.</p>
<ul>
<li><p>Subject 1 was censored at 3 years.</p></li>
<li><p>Subject 3 progressed at 1.74 years.</p></li>
</ul>
<p>For the deferred treatment arm, treatment crossover was allowed.</p>
<ul>
<li><p>Subject 2 crossed over at 2.65 years and was censored at 3
years.</p></li>
<li><p>Subject 5 crossed over at 2.12 years and progressed at 2.88
years.</p></li>
<li><p>Subject 7 progressed at 2.19 years without treatment
crossover.</p></li>
</ul>
</div>
<div id="analysis" class="section level2">
<h2>Analysis</h2>
<p>We begin by preparing the data and then apply the RPSFTM method:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> immdef <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rx =</span> <span class="dv">1</span><span class="sc">-</span>xoyrs<span class="sc">/</span>progyrs)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">rpsftm</span>(</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  data, <span class="at">id =</span> <span class="st">&quot;id&quot;</span>, <span class="at">time =</span> <span class="st">&quot;progyrs&quot;</span>, <span class="at">event =</span> <span class="st">&quot;prog&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;imm&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">rx =</span> <span class="st">&quot;rx&quot;</span>, <span class="at">censor_time =</span> <span class="st">&quot;censyrs&quot;</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The log-rank test for an ITT analysis, which ignores treatment
changes, produces a borderline significant p-value of <span class="math inline">\(0.056\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>fit1<span class="sc">$</span>logrank_pvalue</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.05563532</span></span></code></pre></div>
<p>Using a root-finding algorithm, we estimate <span class="math inline">\(\hat{\psi} = -0.181\)</span>, with a 95%
confidence interval of <span class="math inline">\((-0.350,
0.002)\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">c</span>(fit1<span class="sc">$</span>psi, fit1<span class="sc">$</span>psi_CI)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; [1] -0.181177491 -0.349656153  0.002047545</span></span></code></pre></div>
<p>The plot of <span class="math inline">\(Z(\psi)\)</span> versus <span class="math inline">\(\psi\)</span> shows that the estimation process
worked well.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>psi_CI_width <span class="ot">&lt;-</span> fit1<span class="sc">$</span>psi_CI[<span class="dv">2</span>] <span class="sc">-</span> fit1<span class="sc">$</span>psi_CI[<span class="dv">1</span>]</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">ggplot</span>(fit1<span class="sc">$</span>eval_z <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>         <span class="fu">filter</span>(psi <span class="sc">&gt;</span> fit1<span class="sc">$</span>psi_CI[<span class="dv">1</span>] <span class="sc">-</span> psi_CI_width<span class="sc">*</span><span class="fl">0.25</span> <span class="sc">&amp;</span> </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                  psi <span class="sc">&lt;</span> fit1<span class="sc">$</span>psi_CI[<span class="dv">2</span>] <span class="sc">+</span> psi_CI_width<span class="sc">*</span><span class="fl">0.25</span>), </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>psi, <span class="at">y=</span>Z)) <span class="sc">+</span> </span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>), <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>)) <span class="sc">+</span> </span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(fit1<span class="sc">$</span>psi, fit1<span class="sc">$</span>psi_CI), <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">c</span>(fit1<span class="sc">$</span>psi, fit1<span class="sc">$</span>psi_CI), <span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;log-rank Z&quot;</span>) <span class="sc">+</span> </span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The Kaplan-Meier plot of counterfactual survival times supports the
estimated <span class="math inline">\(\hat{\psi}\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(fit1<span class="sc">$</span>kmstar, <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>survival, <span class="at">group=</span>treated,</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                        <span class="at">linetype=</span><span class="fu">as.factor</span>(treated))) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">geom_step</span>() <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">&quot;treated&quot;</span>) <span class="sc">+</span> </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The estimated hazard ratio from the Cox proportional hazards model is
<span class="math inline">\(0.761\)</span>, with a 95% confidence
interval of <span class="math inline">\((0.575, 1.007)\)</span>,
constructed to be consistent with the p-value from the log-rank test for
the ITT analysis.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">c</span>(fit1<span class="sc">$</span>hr, fit1<span class="sc">$</span>hr_CI)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.7610992 0.5754769 1.0065948</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
